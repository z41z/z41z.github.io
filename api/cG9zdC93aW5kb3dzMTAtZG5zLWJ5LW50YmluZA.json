{"title":"利用NTBIND在Windows10上搭建DNS服务","date":"2020-12-30T01:55:20.094Z","slug":"windows10-dns-by-ntbind","comments":true,"tags":["BIND9","DNS","Windows10","nginx","server_name","内网DNS搭建","域名解析"],"updated":"2021-01-04T01:12:47.234Z","content":"<h4 id=\"0x00-下载并安装BIND9-11-26\">0x00: 下载并安装BIND9.11.26<a href=\"post/windows10-dns-by-ntbind#0x00-下载并安装BIND9-11-26\"></a></h4><p><a href=\"http://ftp.isc.org/isc/bind9/9.11.26/\" target=\"_blank\" rel=\"noopener\">下载</a>BIND9.11.26<a href=\"http://ftp.isc.org/isc/bind9/9.11.26/\" target=\"_blank\" rel=\"noopener\">(http://ftp.isc.org/isc/bind9/9.11.26/)</a><br><img src=\"./../images/download-ntbind.png\" alt=\"下载\"></p>\n<h4 id=\"0x01-安装BIND\">0x01: 安装BIND<a href=\"post/windows10-dns-by-ntbind#0x01-安装BIND\"></a></h4><ul>\n<li>以<code>管理员身份</code>运行<code>BINDInstall.exe</code><br><img src=\"./../images/install-ntbind.png\" alt=\"安装\"></li>\n<li>填写服务密码并安装<br><img src=\"./../images/install-ntbind-set.png\" alt=\"填写密码\"></li>\n</ul>\n<h4 id=\"0x02-设置环境变量\">0x02: 设置环境变量<a href=\"post/windows10-dns-by-ntbind#0x02-设置环境变量\"></a></h4><p><div align=\"left\"><img src=\"./../images/bind-set-env.png\" alt=\"环境变量\"></div></p>\n<h4 id=\"0x03-设置目录读写权限\">0x03: 设置目录读写权限<a href=\"post/windows10-dns-by-ntbind#0x03-设置目录读写权限\"></a></h4><ul>\n<li>右键点击安装目录</li>\n<li>选择<code>安全</code>选项卡后点击<code>编辑</code></li>\n<li>点击<code>添加</code></li>\n<li>点击<code>高级</code>,弹窗后点击<code>立即查找</code>,选中<code>named</code>用户并<code>确定</code></li>\n<li>勾选权限<br><img src=\"./../images/bind-set-sec.png\" alt=\"读写权限\"></li>\n</ul>\n<h4 id=\"0x04-文件配置\">0x04: 文件配置<a href=\"post/windows10-dns-by-ntbind#0x04-文件配置\"></a></h4><ul>\n<li>生成rndc.key:<code>管理员身份</code>运行<code>cmd</code>输入<code>rndc-confgen -a</code></li>\n<li><a href=\"ftp://ftp.rs.internic.net/domain/\" target=\"_blank\" rel=\"noopener\">下载</a><code>named.root</code>和<code>root.zone</code><a href=\"ftp://ftp.rs.internic.net/domain/\" target=\"_blank\" rel=\"noopener\">(ftp://ftp.rs.internic.net/domain/)</a>)</li>\n<li><p>创建<code>localhost.zone</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$TTL</span> 1D</span><br><span class=\"line\">@ IN SOA localhost. root.localhost. (</span><br><span class=\"line\">2007091701  ; Serial</span><br><span class=\"line\">30800  ; Refresh</span><br><span class=\"line\">7200  ; Retry</span><br><span class=\"line\">604800  ; Expire</span><br><span class=\"line\">300 )  ; Minimum</span><br><span class=\"line\">IN NS localhost.</span><br><span class=\"line\">localhost. IN A 192.168.10.178</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>创建<code>localhost.rev</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$TTL</span> 1D</span><br><span class=\"line\">@ IN SOA localhost. root.localhost. (</span><br><span class=\"line\">2007091701  ; Serial</span><br><span class=\"line\">30800  ; Refresh</span><br><span class=\"line\">7200  ; Retry</span><br><span class=\"line\">604800  ; Expire</span><br><span class=\"line\">300 )  ; Minimum</span><br><span class=\"line\">  IN NS localhost.</span><br><span class=\"line\">1  IN PTR localhost.</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>创建<code>named.conf</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">options &#123;</span><br><span class=\"line\">  // zone文件的位置</span><br><span class=\"line\">  directory <span class=\"string\">\"C:\\Program Files\\ISC BIND 9\\etc\"</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">// localhost</span><br><span class=\"line\">zone <span class=\"string\">\"localhost\"</span> IN &#123;</span><br><span class=\"line\">  <span class=\"built_in\">type</span> master;</span><br><span class=\"line\">  file <span class=\"string\">\"localhost.zone\"</span>;</span><br><span class=\"line\">  allow-update &#123; none; &#125;;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">// localhost的反向解析</span><br><span class=\"line\">zone <span class=\"string\">\"0.0.127.in-addr.arpa\"</span> &#123;</span><br><span class=\"line\">  <span class=\"built_in\">type</span> master;</span><br><span class=\"line\">  file <span class=\"string\">\"localhost.rev\"</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">// 根DNS</span><br><span class=\"line\">zone <span class=\"string\">\".\"</span> &#123;</span><br><span class=\"line\">  <span class=\"built_in\">type</span> hint;</span><br><span class=\"line\">  file <span class=\"string\">\"root.zone\"</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">// 123.com是我们为自己的域的正向解析配置</span><br><span class=\"line\">zone <span class=\"string\">\"123.com\"</span> IN &#123;</span><br><span class=\"line\">  <span class=\"built_in\">type</span> master;</span><br><span class=\"line\">  file <span class=\"string\">\"123.com.zone\"</span>;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>创建<code>123.com.zone</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">123.com. IN SOA ns1.123.com. root.123.com. (</span><br><span class=\"line\">2007091701  ; Serial</span><br><span class=\"line\">30800  ; Refresh</span><br><span class=\"line\">7200  ; Retry</span><br><span class=\"line\">604800  ; Expire</span><br><span class=\"line\">300 )  ; Minimum</span><br><span class=\"line\">IN NS ns1.123.com.</span><br><span class=\"line\">* IN A  192.168.10.178</span><br><span class=\"line\">www IN A  192.168.10.203</span><br><span class=\"line\"><span class=\"built_in\">test</span> IN A  192.168.10.203</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>将<code>named.root</code>,<code>root.zone</code>,<code>localhost.zone</code>,<code>localhost.rev</code>,<code>named.conf</code>,<code>123.com.zone</code>放在安装目录<code>etc</code>子目录下(或者<a href=\"../files/bind.zip\">下载</a>)。</p>\n</li>\n</ul>\n<h4 id=\"0x05-nginx主要配置\">0x05: nginx主要配置<a href=\"post/windows10-dns-by-ntbind#0x05-nginx主要配置\"></a></h4>  <figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">server</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">listen</span> <span class=\"number\">80</span>;</span><br><span class=\"line\">  <span class=\"attribute\">server_name</span> www.<span class=\"number\">123</span>.com;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"section\">server</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">listen</span> <span class=\"number\">80</span>;</span><br><span class=\"line\">  <span class=\"attribute\">server_name</span> test.<span class=\"number\">123</span>.com;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"0x06-关闭防火墙或者防火墙规则开放53端口\">0x06: 关闭防火墙或者防火墙规则开放53端口<a href=\"post/windows10-dns-by-ntbind#0x06-关闭防火墙或者防火墙规则开放53端口\"></a></h4><h4 id=\"0x07-启动服务\">0x07: 启动服务<a href=\"post/windows10-dns-by-ntbind#0x07-启动服务\"></a></h4><p><div align=\"left\"> <img src=\"./../images/bind-run.png\" alt=\"启动服务\"></div></p>\n<h4 id=\"0x08-使用\">0x08: 使用<a href=\"post/windows10-dns-by-ntbind#0x08-使用\"></a></h4><p>  其他机器设置DNS为<code>192.168.10.178</code>即可。<br>  <img src=\"./../images/bind-set-dns.png\" alt=\"设置DNS\"><br>  <img src=\"./../images/bind-ping.png\" alt=\"ping\"></p>\n<h4 id=\"0x09-参考\">0x09: 参考<a href=\"post/windows10-dns-by-ntbind#0x09-参考\"></a></h4><ul>\n<li><a href=\"https://www.cnblogs.com/Dy1an/p/11157152.html\" target=\"_blank\" rel=\"noopener\">DNS：从零搭建公司内网DNS服务器</a></li>\n<li><a href=\"https://blog.51cto.com/pangge/1273087\" target=\"_blank\" rel=\"noopener\">DNS服务器全面解析</a></li>\n<li><a href=\"https://www.cnblogs.com/saneri/p/8038070.html\" target=\"_blank\" rel=\"noopener\">DNS Bind服务配置解析</a></li>\n<li><a href=\"https://blog.csdn.net/kadwf123/article/details/106201196\" target=\"_blank\" rel=\"noopener\">Windows10个人版使用NTBIND搭建DNS服务</a></li>\n</ul>\n","prev":{"title":"对vue-element-admin@4.4.0构建的优化","slug":"vue-element-admin-webpack-performance"},"next":{"title":"通过Puppeteer获取或者导出网页富文本内容","slug":"export-rich-text-to-pdf-by-puppeteer"},"link":"https://www.alipay.one/post/windows10-dns-by-ntbind/"}