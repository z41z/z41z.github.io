{"title":"Ubuntu16.04安装VNC和EasyConnect","date":"2020-07-27T08:30:17.925Z","slug":"ubuntu-install-vnc-and-easy-connection","comments":true,"tags":["EasyConnect","Ubuntu","VNC","Xlib XInputExtension"],"updated":"2020-12-24T07:13:50.262Z","content":"<h3 id=\"更新软件源\">更新软件源<a href=\"post/ubuntu-install-vnc-and-easy-connection#更新软件源\"></a></h3><h4 id=\"0x00：-备份软件源\">0x00： 备份软件源<a href=\"post/ubuntu-install-vnc-and-easy-connection#0x00：-备份软件源\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak</span><br></pre></td></tr></table></figure>\n<h4 id=\"0x02：修改软件源\">0x02：修改软件源<a href=\"post/ubuntu-install-vnc-and-easy-connection#0x02：修改软件源\"></a></h4>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo vim /etc/apt/sources.list</span><br></pre></td></tr></table></figure>\n<p>  将文件内容替换为<br>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deb-src http://archive.ubuntu.com/ubuntu xenial main restricted</span><br><span class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted</span><br><span class=\"line\">deb-src http://mirrors.aliyun.com/ubuntu/ xenial main restricted multiverse universe</span><br><span class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted</span><br><span class=\"line\">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted multiverse universe</span><br><span class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial universe</span><br><span class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-updates universe</span><br><span class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial multiverse</span><br><span class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-updates multiverse</span><br><span class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse</span><br><span class=\"line\">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse</span><br><span class=\"line\">deb http://archive.canonical.com/ubuntu xenial partner</span><br><span class=\"line\">deb-src http://archive.canonical.com/ubuntu xenial partner</span><br><span class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted</span><br><span class=\"line\">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted multiverse universe</span><br><span class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-security universe</span><br><span class=\"line\">deb http://mirrors.aliyun.com/ubuntu/ xenial-security multiverse</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"0x03：更新\">0x03：更新<a href=\"post/ubuntu-install-vnc-and-easy-connection#0x03：更新\"></a></h4>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get update &amp;&amp; sudo apt-get upgrade</span><br></pre></td></tr></table></figure>\n<h3 id=\"安装VNC\">安装VNC<a href=\"post/ubuntu-install-vnc-and-easy-connection#安装VNC\"></a></h3><h4 id=\"0x00：安装vnc服务端\">0x00：安装vnc服务端<a href=\"post/ubuntu-install-vnc-and-easy-connection#0x00：安装vnc服务端\"></a></h4>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install vnc4server</span><br></pre></td></tr></table></figure>\n<p>  安装完成后输入<code>vncserver</code>设置VNC密码<br>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vncserver</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"0x01：连接VNC\">0x01：连接VNC<a href=\"post/ubuntu-install-vnc-and-easy-connection#0x01：连接VNC\"></a></h4><p>  用<a href=\"https://www.realvnc.com/en/connect/download/viewer/windows/\" target=\"_blank\" rel=\"noopener\">VNC Viewer</a>连接VNC，默认端口<code>5901</code><br>  <img src=\"/images/vnc-viewer-connect.png\" alt=\"连接VNC\"></p>\n<h4 id=\"0x02：修改VNC端口\">0x02：修改VNC端口<a href=\"post/ubuntu-install-vnc-and-easy-connection#0x02：修改VNC端口\"></a></h4><p>  查看<code>vncserver</code>路径<br>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">which</span> vncserver</span><br></pre></td></tr></table></figure></p>\n<p>  <img src=\"/images/which-vncserver.png\" alt=\"which-vncserver\"><br>  查找vnc配置,一直输入<code>file</code>命令直到显示<code>/usr/bin/vnc4server: a /usr/bin/env perl script, ASCII text executable</code><br>  <img src=\"/images/vnc-file.png\" alt=\"which-vncserver\"><br>  查找端口配置的行序号<br>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">grep <span class=\"string\">\"59\"</span> /usr/bin/vnc4server -n</span><br></pre></td></tr></table></figure></p>\n<p>  <img src=\"/images/vnc-find-port.png\" alt=\"vnc-find-port\"><br>  我这里是第<code>212</code>和<code>468</code>行<br>  编辑<code>vnc</code>配置对应的行,将<code>5900</code>修改为自己的端口(我这里设置为<code>6660</code>)。<br>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo vi /usr/bin/vnc4server</span><br></pre></td></tr></table></figure></p>\n<p>  <img src=\"/images/vnc-change-port.png\" alt=\"vnc-find-port\"><br>  重启VNC<br>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vncserver -<span class=\"built_in\">kill</span> :1</span><br></pre></td></tr></table></figure></p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vncserver :1</span><br></pre></td></tr></table></figure>\n<p>  用<a href=\"https://www.realvnc.com/en/connect/download/viewer/windows/\" target=\"_blank\" rel=\"noopener\">VNC Viewer</a>再次连接VNC<br>  <img src=\"/images/vnc-new-port.png\" alt=\"vnc-new-port.png\"></p>\n<h4 id=\"0x03：安装桌面环境\">0x03：安装桌面环境<a href=\"post/ubuntu-install-vnc-and-easy-connection#0x03：安装桌面环境\"></a></h4><p>  安装桌面基础<br>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install x-window-system-core</span><br></pre></td></tr></table></figure></p>\n<p>  安装登陆管理器<br>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install gdm</span><br></pre></td></tr></table></figure></p>\n<p>  安装Ubuntu的桌面<br>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install ubuntu-desktop</span><br></pre></td></tr></table></figure></p>\n<p>  安装gnome配套<br>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install gnome-panel gnome-settings-daemon metacity nautilus gnome-terminal</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"0x04：修改VNC配置\">0x04：修改VNC配置<a href=\"post/ubuntu-install-vnc-and-easy-connection#0x04：修改VNC配置\"></a></h4><p>  编辑<code>vim ~/.vnc/xstartup</code>,将内容修改为<br>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/sh</span></span><br><span class=\"line\"><span class=\"comment\"># Uncomment the following two lines for normal desktop:</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> XKL_XMODMAP_DISABLE=1</span><br><span class=\"line\"><span class=\"built_in\">unset</span> SESSION_MANAGER</span><br><span class=\"line\"><span class=\"comment\"># exec /etc/X11/xinit/xinitrc</span></span><br><span class=\"line\"><span class=\"built_in\">unset</span> DBUS_SESSION_BUS_ADDRESS</span><br><span class=\"line\">gnome-panel &amp;</span><br><span class=\"line\">gnome-settings-daemon &amp;</span><br><span class=\"line\">metacity &amp;</span><br><span class=\"line\">nautilus &amp;</span><br><span class=\"line\">gnome-terminal &amp;</span><br></pre></td></tr></table></figure></p>\n<p>  重启VNC<br>  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vncserver -<span class=\"built_in\">kill</span> :1</span><br></pre></td></tr></table></figure></p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vncserver :1</span><br></pre></td></tr></table></figure>\n<h4 id=\"0x05：连接VNC服务器\">0x05：连接VNC服务器<a href=\"post/ubuntu-install-vnc-and-easy-connection#0x05：连接VNC服务器\"></a></h4><p>  用<a href=\"https://www.realvnc.com/en/connect/download/viewer/windows/\" target=\"_blank\" rel=\"noopener\">VNC Viewer</a>连接VNC<br>  <img src=\"/images/vnc-gnome.png\" alt=\"vnc-gnome.png\"></p>\n<h3 id=\"安装EasyConnect\">安装EasyConnect<a href=\"post/ubuntu-install-vnc-and-easy-connection#安装EasyConnect\"></a></h3><h4 id=\"下载安装包\">下载安装包<a href=\"post/ubuntu-install-vnc-and-easy-connection#下载安装包\"></a></h4><p>下载地址:<a href=\"http://uploads.shybey.com/EasyConnect_x64_7_6_7_3.deb\" target=\"_blank\" rel=\"noopener\">EasyConnect_x64_7_6_7_3.deb</a></p>\n<h4 id=\"安装EasyConnect-1\">安装EasyConnect<a href=\"post/ubuntu-install-vnc-and-easy-connection#安装EasyConnect-1\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 默认安装位置/usr/share/sangfor/EasyConnect/EasyConnect</span></span><br><span class=\"line\">sudo dpkg -i EasyConnect_x64_7_6_7_3.deb</span><br></pre></td></tr></table></figure>\n<h4 id=\"运行EasyConnect\">运行EasyConnect<a href=\"post/ubuntu-install-vnc-and-easy-connection#运行EasyConnect\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /usr/share/sangfor/EasyConnect/EasyConnect</span><br><span class=\"line\">./EasyConnect</span><br></pre></td></tr></table></figure>\n<h4 id=\"Xlib-XInputExtension错误解决\">Xlib XInputExtension错误解决<a href=\"post/ubuntu-install-vnc-and-easy-connection#Xlib-XInputExtension错误解决\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 备份</span></span><br><span class=\"line\">sudo cp /usr/lib/x86_64-linux-gnu/libxcb.so.1 libxcb.so.1.bk</span><br><span class=\"line\"><span class=\"comment\"># 写入内容</span></span><br><span class=\"line\">sudo sed -i <span class=\"string\">'s/BIG-REQUESTS/_IG-REQUESTS/'</span> libxcb.so.1</span><br></pre></td></tr></table></figure>\n<h4 id=\"运行并登陆EasyConnect\">运行并登陆EasyConnect<a href=\"post/ubuntu-install-vnc-and-easy-connection#运行并登陆EasyConnect\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /usr/share/sangfor/EasyConnect/EasyConnect</span><br><span class=\"line\">./EasyConnect</span><br></pre></td></tr></table></figure>\n<div class=\"article-img\"><p><img src=\"/images/easyconnect-login.png\" alt=\"vnc-gnome.png\" data-zoomable></p></div>\n","prev":{"title":"通过Windows10注册表修改系统服务自启动方式","slug":"windows10-common-regedit-options"},"next":{"title":"利用FontSpider压缩网页字体静态文件","slug":"compress-font-file-by-font-spider"},"link":"https://www.alipay.one/post/ubuntu-install-vnc-and-easy-connection/"}