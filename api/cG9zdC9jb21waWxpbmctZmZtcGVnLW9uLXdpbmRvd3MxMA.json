{"title":"Windows环境下编译FFmpeg","date":"2019-07-29T04:59:05.315Z","slug":"compiling-ffmpeg-on-windows10","comments":true,"updated":"2019-07-30T01:41:16.352Z","content":"<h3 id=\"0x00-FFmpeg概述\">0x00: FFmpeg概述<a href=\"post/compiling-ffmpeg-on-windows10#0x00-FFmpeg概述\"></a></h3><p>FFmpeg 是一个自由软件，可以运行音频和视频多种格式的录影、转换、流功能，包含了libavcodec(这是一个用于多个项目中音频和视频的解码器库)，以及libavformat(一个音频与视频格式转换库)。 “FFmpeg”这个单词中的“FF”指的是“Fast Forward”。 via <a href=\"https://zh.wikipedia.org/zh-cn/FFmpeg\" target=\"_blank\" rel=\"noopener\">维基百科</a> </p>\n<h3 id=\"0x01：下载及准备\">0x01：下载及准备<a href=\"post/compiling-ffmpeg-on-windows10#0x01：下载及准备\"></a></h3><ul>\n<li><a href=\"https://ffmpeg.org/download.html\" target=\"_blank\" rel=\"noopener\">FFmpeg</a>(<a href=\"https://ffmpeg.org/download.html\" target=\"_blank\" rel=\"noopener\">https://ffmpeg.org/download.html</a>)</li>\n<li><a href=\"http://yasm.tortall.net/Download.html\" target=\"_blank\" rel=\"noopener\">yasm</a>(<a href=\"http://yasm.tortall.net/Download.html\" target=\"_blank\" rel=\"noopener\">http://yasm.tortall.net/Download.html</a>)</li>\n<li><a href=\"http://www.libsdl.org/download-1.2.php\" target=\"_blank\" rel=\"noopener\">SDL</a>(<a href=\"http://www.libsdl.org/download-1.2.php\" target=\"_blank\" rel=\"noopener\">http://www.libsdl.org/download-1.2.php</a>)</li>\n<li><a href=\"https://www.videolan.org/developers/x264.html\" target=\"_blank\" rel=\"noopener\">x264</a>(<a href=\"https://www.videolan.org/developers/x264.html\" target=\"_blank\" rel=\"noopener\">https://www.videolan.org/developers/x264.html</a>)</li>\n<li><a href=\"https://osdn.net/projects/mingw/releases/68260\" target=\"_blank\" rel=\"noopener\">MinGW</a>(<a href=\"https://osdn.net/projects/mingw/releases/68260\" target=\"_blank\" rel=\"noopener\">https://osdn.net/projects/mingw/releases/68260</a>)</li>\n</ul>\n<h3 id=\"0x02：环境说明\">0x02：环境说明<a href=\"post/compiling-ffmpeg-on-windows10#0x02：环境说明\"></a></h3><ul>\n<li>操作系统：Windows 10家庭版64位</li>\n</ul>\n<h3 id=\"0x03：下载并安装MinGW\">0x03：下载并安装MinGW<a href=\"post/compiling-ffmpeg-on-windows10#0x03：下载并安装MinGW\"></a></h3><div class=\"article-img\"><p><img src=\"/images/download-mingw.png\" alt=\"下载MinGW\" data-zoomable></p></div>\n<h3 id=\"0x04：运行MinGW并安装基础包\">0x04：运行MinGW并安装基础包<a href=\"post/compiling-ffmpeg-on-windows10#0x04：运行MinGW并安装基础包\"></a></h3><div class=\"article-img\"><p><img src=\"/images/mingw-basic-setup.png\" alt=\"运行MinGW并安装基础包\" data-zoomable><br><img src=\"/images/mingw-basic-setup-apply.png\" alt=\"运行MinGW并安装基础包\" data-zoomable></p></div>\n<blockquote>\n<p>Tips:安装错误继续即可，然后再重新“Apply Changes”，或者退出再安装未安装的包。</p>\n</blockquote>\n<h3 id=\"0x05：下载yasm\">0x05：下载yasm<a href=\"post/compiling-ffmpeg-on-windows10#0x05：下载yasm\"></a></h3><div class=\"article-img\"><p><img src=\"/images/download-yasm.png\" alt=\"下载yasm\" data-zoomable></p></div>\n<h3 id=\"0x06：将下载完成的yasm可执行文件文件名修改为为yasm并放入MinGW安装目录下的bin子文件夹下\">0x06：将下载完成的yasm可执行文件文件名修改为为yasm并放入MinGW安装目录下的bin子文件夹下<a href=\"post/compiling-ffmpeg-on-windows10#0x06：将下载完成的yasm可执行文件文件名修改为为yasm并放入MinGW安装目录下的bin子文件夹下\"></a></h3><div class=\"article-img\"><p><img src=\"/images/rename-yasm.png\" alt=\"0x04：将下载完成的yasm可执行文件文件名修改为为yasm并放入MinGW安装目录下的bin子文件夹下\" data-zoomable></p></div>\n<h3 id=\"0x07：打开MinGW安装目录下的msys-1-0-msys-bat\">0x07：打开MinGW安装目录下的msys\\1.0\\msys.bat<a href=\"post/compiling-ffmpeg-on-windows10#0x07：打开MinGW安装目录下的msys-1-0-msys-bat\"></a></h3><h3 id=\"0x08：编译x264\">0x08：编译x264<a href=\"post/compiling-ffmpeg-on-windows10#0x08：编译x264\"></a></h3><ul>\n<li><h4 id=\"解压下载完成的x264文件\"><a href=\"#解压下载完成的x264文件\" class=\"headerlink\" title=\"解压下载完成的x264文件\"></a>解压下载完成的x264文件</h4></li>\n<li><h4 id=\"在msys终端中切换到解压的目录并编译\"><a href=\"#在msys终端中切换到解压的目录并编译\" class=\"headerlink\" title=\"在msys终端中切换到解压的目录并编译\"></a>在msys终端中切换到解压的目录并编译</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./configure --<span class=\"built_in\">enable</span>-shared --<span class=\"built_in\">disable</span>-asm --prefix=填写输出目录</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">make</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">make install</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"0x09：编译SDL\">0x09：编译SDL<a href=\"post/compiling-ffmpeg-on-windows10#0x09：编译SDL\"></a></h3><ul>\n<li><h4 id=\"解压下载完成的SDL文件\"><a href=\"#解压下载完成的SDL文件\" class=\"headerlink\" title=\"解压下载完成的SDL文件\"></a>解压下载完成的SDL文件</h4></li>\n<li><h4 id=\"在msys终端中切换到解压的目录并编译-1\"><a href=\"#在msys终端中切换到解压的目录并编译-1\" class=\"headerlink\" title=\"在msys终端中切换到解压的目录并编译\"></a>在msys终端中切换到解压的目录并编译</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./configure --prefix=填写输出目录</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">make</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">make install</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"0x10：将编译好的x264和SDL中bin、lib、include内所有文件拷贝到MinGW对应的文件夹下\">0x10：将编译好的x264和SDL中bin、lib、include内所有文件拷贝到MinGW对应的文件夹下<a href=\"post/compiling-ffmpeg-on-windows10#0x10：将编译好的x264和SDL中bin、lib、include内所有文件拷贝到MinGW对应的文件夹下\"></a></h3><h3 id=\"0x11：在msys终端中切换到解压的目录\">0x11：在msys终端中切换到解压的目录<a href=\"post/compiling-ffmpeg-on-windows10#0x11：在msys终端中切换到解压的目录\"></a></h3><h3 id=\"0x12：下载FFmpeg源代码并解压到指定位置\">0x12：下载FFmpeg源代码并解压到指定位置<a href=\"post/compiling-ffmpeg-on-windows10#0x12：下载FFmpeg源代码并解压到指定位置\"></a></h3><div class=\"article-img\"><p><img src=\"/images/download-ffmpeg.png\" alt=\"下载FFmpeg\" data-zoomable></p></div>\n<h3 id=\"0x13：编译FFmpeg\">0x13：编译FFmpeg<a href=\"post/compiling-ffmpeg-on-windows10#0x13：编译FFmpeg\"></a></h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./configure --<span class=\"built_in\">enable</span>-shared --<span class=\"built_in\">disable</span>-static --<span class=\"built_in\">enable</span>-libx264 --<span class=\"built_in\">enable</span>-sdl2 --<span class=\"built_in\">enable</span>-gpl --<span class=\"built_in\">enable</span>-nonfree --prefix=填写输出目录</span><br></pre></td></tr></table></figure>\n<p>成功后执行命令<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">make</span><br></pre></td></tr></table></figure></p>\n<blockquote>\n<p>Tips:可能会发生报错， error: ‘ERROR_NOT_ENOUGH_MEMORY’ undeclared (first use in this function)，打开<code>libavformat/os_support.h</code>, 添加<code>#include &lt;winerror.h&gt;</code>再执行<code>./configure --enable-shared --disable-static --enable-libx264 --enable-sdl2 --enable-gpl --enable-nonfree --prefix=填写输出目录</code></p>\n</blockquote>\n<p>最后执行命令<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">make install</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"0xFF：参考\">0xFF：参考<a href=\"post/compiling-ffmpeg-on-windows10#0xFF：参考\"></a></h3><ul>\n<li><a href=\"https://ffmpeg.zeranoe.com/builds/readme/win64/static/ffmpeg-20190727-47b6ca0-win64-static-readme.txt\" target=\"_blank\" rel=\"noopener\">FFmpeg README</a></li>\n<li><a href=\"https://www.easydarwin.org/article/Streaming/40.html\" target=\"_blank\" rel=\"noopener\">专题：Windows编译x264、SDL、faac、ffmpeg过程</a></li>\n</ul>\n","next":{"title":"Hello World","slug":"hello-world"},"link":"https://www.alipay.one/post/compiling-ffmpeg-on-windows10/"}